# WARNING: Funzionante ma richiede importante intervento umano (trasformabile in gioco)
# Scopo: estrazione dati totale casi positivi (attivi) comunali Regione Piemonte da https://opengis.csi.it/tiles/


from selenium import webdriver
from bs4 import BeautifulSoup

import time

mypath='D:\script\drivers\chromedriver.exe'

lista_comuni=['Acceglio', 'Acqui Terme', 'Agliano Terme', "Aglie'", 'Agrate Conturbia', 'Ailoche', 'Airasca', 'Aisone', 'Ala di Stura', 'Alagna Valsesia', 'Alba', 'Albano Vercellese', 'Albaretto della Torre', 'Albera Ligure', "Albiano d'Ivrea", 'Albugnano', 'ALESSANDRIA', 'Alfiano Natta', 'Alice Bel Colle', 'Alice Castello', 'Alluvioni Piovera', 'Almese', 'Alpette', 'Alpignano', 'Altavilla Monferrato', 'Alto', 'Alto Sermenza', 'Alzano Scrivia', 'Ameno', 'Andezeno', 'Andorno Micca', 'Andrate', 'Angrogna', 'Antignano', 'Antrona Schieranco', "Anzola d'Ossola", 'Aramengo', 'Arborio', 'Argentera', 'Arguello', 'Arignano', 'Arizzano', 'Armeno', 'Arola', 'Arona', 'Arquata Scrivia', 'Asigliano Vercellese', 'ASTI', 'Aurano', 'Avigliana', 'Avolasca', 'Azeglio', "Azzano d'Asti", 'Baceno', 'Bagnasco', 'Bagnolo Piemonte', 'Bairo', 'Balangero', "Baldichieri d'Asti", 'Baldissero Canavese', "Baldissero d'Alba", 'Baldissero Torinese', 'Balme', 'Balmuccia', 'Balocco', 'Balzola', 'Banchette', 'Bannio Anzino', 'Barbania', 'Barbaresco', 'Bardonecchia', 'Barengo', 'Barge', 'Barolo', 'Barone Canavese', 'Basaluzzo', 'Bassignana', "Bastia Mondovi'", 'Battifollo', 'Baveno', 'Bee', 'Beinasco', 'Beinette', 'Belforte Monferrato', 'Belgirate', 'Bellino', 'Bellinzago Novarese', 'Belvedere Langhe', 'Belveglio', 'Bene Vagienna', 'Benevello', 'Benna', 'Bergamasco', 'Bergolo', 'Bernezzo', 'Berzano di San Pietro', 'Berzano di Tortona', 'Beura-Cardezza', 'Biandrate', "Bianze'", 'Bibiana', 'BIELLA', 'Bioglio', 'Bistagno', 'Bobbio Pellice', 'Boca', 'Boccioleto', 'Bognanco', 'Bogogno', 'Bollengo', 'Bolzano Novarese', 'Bonvicino', 'Borgaro Torinese', 'Borghetto di Borbera', 'Borgiallo', "Borgo d'Ale", 'Borgo San Dalmazzo', 'Borgo San Martino', 'Borgo Ticino', 'Borgo Vercelli', "Borgofranco d'Ivrea", 'Borgolavezzaro', 'Borgomale', 'Borgomanero', 'Borgomasino', 'Borgomezzavalle', 'Borgone Susa', 'Borgoratto Alessandrino', 'Borgosesia', 'Borriana', 'Bosco Marengo', 'Bosconero', 'Bosia', 'Bosio', 'Bossolasco', 'Boves', 'Bozzole', 'Bra', 'Brandizzo', 'Briaglia', 'Bricherasio', 'Briga Alta', 'Briga Novarese', 'Brignano-Frascata', 'Briona', 'Brondello', 'Brossasco', 'Brosso', 'Brovello-Carpugnino', 'Brozolo', 'Bruino', 'Bruno', 'Brusasco', 'Brusnengo', 'Bruzolo', 'Bubbio', 'Buriasco', 'Burolo', 'Buronzo', 'Busano', 'Busca', 'Bussoleno', 'Buttigliera Alta', "Buttigliera d'Asti", 'Cabella Ligure', 'Cafasse', 'Calamandrana', 'Calasca-Castiglione', 'Callabiana', 'Calliano', 'Calosso', 'Caltignaga', 'Caluso', 'Camagna Monferrato', 'Camandona', 'Cambiano', 'Cambiasca', 'Camburzano', 'Camerana', 'Camerano Casasco', 'Cameri', 'Camino', 'Campertogno', 'Campiglia Cervo', 'Campiglione Fenile', 'Canale', 'Candelo', 'Candia Canavese', 'Candiolo', 'Canelli', 'Canischio', 'Cannero Riviera', 'Cannobio', 'Canosio', 'Cantalupa', 'Cantalupo Ligure', 'Cantarana', 'Cantoira', 'Caprauna', 'Caprezzo', "Capriata d'Orba", 'Caprie', 'Capriglio', 'Caprile', 'Caraglio', 'Caramagna Piemonte', 'Caravino', 'Carbonara Scrivia', 'Carcoforo', "Carde'", 'Carema', 'Carentino', 'Caresana', 'Caresanablot', 'Carezzano', 'Carignano', 'Carisio', 'Carmagnola', 'Carpeneto', 'Carpignano Sesia', 'Carrega Ligure', 'Carrosio', "Carru'", 'Cartignano', 'Cartosio', 'Casal Cermelli', 'Casalbeltrame', 'Casalborgone', 'Casale Corte Cerro', 'Casale Monferrato', 'Casaleggio Boiro', 'Casaleggio Novara', 'Casalgrasso', 'Casalino', 'Casalnoceto', 'Casalvolone', 'Casanova Elvo', 'Casapinta', 'Casasco', "Cascinette d'Ivrea", 'Caselette', 'Caselle Torinese', 'Casorzo', 'Cassano Spinola', 'Cassinasco', 'Cassine', 'Cassinelle', 'Castagneto Po', 'Castagnito', 'Castagnole delle Lanze', 'Castagnole Monferrato', 'Castagnole Piemonte', 'Castel Boglione', 'Castel Rocchero', 'Casteldelfino', "Castell'Alfero", 'Castellamonte', 'Castellania', 'Castellar Guidobono', 'Castellazzo Bormida', 'Castellazzo Novarese', 'Castellero', 'Castelletto Cervo', "Castelletto d'Erro", "Castelletto d'Orba", 'Castelletto Merli', 'Castelletto Molina', 'Castelletto Monferrato', 'Castelletto sopra Ticino', 'Castelletto Stura', 'Castelletto Uzzone', "Castellinaldo d'Alba", 'Castellino Tanaro', 'Castello di Annone', 'Castelmagno', 'Castelnuovo Belbo', 'Castelnuovo Bormida', 'Castelnuovo Calcea', 'Castelnuovo di Ceva', 'Castelnuovo Don Bosco', 'Castelnuovo Nigra', 'Castelnuovo Scrivia', 'Castelspina', 'Castiglione Falletto', 'Castiglione Tinella', 'Castiglione Torinese', 'Castino', "Cavaglia'", 'Cavaglietto', "Cavaglio d'Agogna", 'Cavagnolo', 'Cavallerleone', 'Cavallermaggiore', 'Cavallirio', 'Cavatore', 'Cavour', 'Cella Monte', 'Cellarengo', 'Celle di Macra', 'Celle Enomondo', 'Cellio con Breia', 'Centallo', 'Ceppo Morelli', 'Cerano', 'Cercenasco', 'Ceres', 'Cereseto', 'Ceresole Alba', 'Ceresole Reale', "Cerreto d'Asti", 'Cerreto Grue', 'Cerretto Langhe', 'Cerrina Monferrato', 'Cerrione', 'Cerro Tanaro', 'Cervasca', 'Cervatto', 'Cervere', 'Cesana Torinese', 'Cesara', 'Cessole', 'Ceva', 'Cherasco', 'Chialamberto', 'Chianocco', 'Chiaverano', 'Chieri', 'Chiesanuova', 'Chiomonte', 'Chiusa di Pesio', 'Chiusa di San Michele', "Chiusano d'Asti", 'Chivasso', 'Ciconio', 'Cigliano', "Ciglie'", 'Cinaglio', 'Cintano', 'Cinzano', "Cirie'", 'Cissone', "Cisterna d'Asti", 'Civiasco', 'Clavesana', 'Claviere', 'Coassolo Torinese', 'Coazze', 'Coazzolo', 'Cocconato', 'Coggiola', 'Colazza', 'Collegno', 'Colleretto Castelnuovo', 'Colleretto Giacosa', 'Collobiano', 'Comignago', 'Condove', 'Coniolo', 'Conzano', 'Corio', "Corneliano d'Alba", 'Corsione', 'Cortandone', 'Cortanze', 'Cortazzone', 'Cortemilia', 'Cortiglione', 'Cossano Belbo', 'Cossano Canavese', 'Cossato', 'Cossogno', 'Cossombrato', 'Costa Vescovato', 'Costanzana', "Costigliole d'Asti", 'Costigliole Saluzzo', 'Cravagliana', 'Cravanzana', 'Craveggia', 'Cremolino', 'Crescentino', 'Cressa', 'Crevacuore', 'Crevoladossola', 'Crissolo', 'Crodo', 'Crova', 'Cuceglio', 'Cumiana', 'CUNEO', 'Cunico', "Cuorgne'", 'Cureggio', 'Curino', 'Demonte', 'Denice', 'Dernice', 'Desana', "Diano d'Alba", 'Divignano', 'Dogliani', 'Domodossola', 'Donato', 'Dormelletto', 'Dorzano', 'Dronero', 'Druento', 'Druogno', 'Dusino San Michele', 'Elva', 'Entracque', 'Envie', 'Exilles', 'Fabbrica Curone', 'Fara Novarese', 'Farigliano', 'Faule', 'Favria', 'Feisoglio', 'Feletto', 'Felizzano', 'Fenestrelle', 'Ferrere', 'Fiano', 'Fiorano Canavese', 'Fobello', 'Foglizzo', "Fontaneto d'Agogna", 'Fontanetto Po', 'Fontanile', 'Formazza', 'Formigliana', 'Forno Canavese', 'Fossano', 'Frabosa Soprana', 'Frabosa Sottana', 'Fraconalto', 'Francavilla Bisio', 'Frascaro', 'Frassinello Monferrato', 'Frassineto Po', 'Frassinetto', 'Frassino', 'Fresonara', 'Frinco', 'Front', 'Frossasco', 'Frugarolo', 'Fubine', 'Gabiano', 'Gaglianico', 'Gaiola', 'Galliate', 'Gamalero', 'Gambasca', 'Garbagna', 'Garbagna Novarese', 'Garessio', 'Gargallo', 'Garzigliana', 'Gassino Torinese', 'Gattico-Veruno', 'Gattinara', 'Gavi', 'Genola', 'Germagnano', 'Germagno', 'Ghemme', 'Ghiffa', 'Ghislarengo', 'Giaglione', 'Giarole', 'Giaveno', 'Gifflenga', 'Gignese', 'Givoletto', 'Gorzegno', 'Gottasecca', 'Govone', 'Gozzano', 'Graglia', 'Grana', 'Granozzo con Monticello', 'Gravellona Toce', 'Gravere', 'Grazzano Badoglio', 'Greggio', 'Gremiasco', 'Grignasco', 'Grinzane Cavour', 'Grognardo', 'Grondona', 'Groscavallo', 'Grosso', 'Grugliasco', 'Guardabosone', 'Guarene', 'Guazzora', 'Gurro', 'Igliano', 'Incisa Scapaccino', 'Ingria', 'Intragna', 'Inverso Pinasca', 'Invorio', 'Isasca', "Isola d'Asti", "Isola Sant'Antonio", 'Isolabella', 'Issiglio', 'Ivrea', 'La Cassa', 'La Loggia', 'La Morra', 'Lagnasco', 'Lamporo', 'Landiona', 'Lanzo Torinese', 'Lauriano', "Leini'", 'Lemie', 'Lenta', 'Lequio Berria', 'Lequio Tanaro', 'Lerma', 'Lesa', 'Lesegno', 'Lessolo', 'Lessona', 'Levice', 'Levone', 'Lignana', 'Limone Piemonte', 'Lisio', 'Livorno Ferraris', 'Loazzolo', 'Locana', 'Lombardore', 'Lombriasco', "Loranze'", 'Loreglia', 'Lozzolo', 'Lu e Cuccaro Monferrato', 'Luserna San Giovanni', 'Lusernetta', "Lusiglie'", 'Macello', 'Macra', 'Macugnaga', 'Madonna del Sasso', 'Maggiora', 'Magliano Alfieri', 'Magliano Alpi', 'Maglione', 'Magnano', 'Malesco', 'Malvicino', 'Mandello Vitta', 'Mango', 'Manta', 'Mappano', 'Marano Ticino', 'Maranzana', 'Marene', 'Marentino', 'Maretto', 'Margarita', 'Marmora', 'Marsaglia', 'Martiniana Po', 'Masera', 'Masio', 'Massazza', 'Massello', 'Masserano', 'Massino Visconti', 'Massiola', 'Mathi', 'Mattie', "Mazze'", 'Meana di Susa', 'Meina', 'Melazzo', 'Melle', 'Merana', 'Mercenasco', 'Mergozzo', 'Mezzana Mortigliengo', 'Mezzenile', 'Mezzomerico', 'Miagliano', 'Miasino', 'Miazzina', 'Mirabello Monferrato', 'Moasca', 'Moiola', 'Molare', 'Molino dei Torti', 'Mollia', 'Mombaldone', 'Mombarcaro', 'Mombaruzzo', 'Mombasiglio', 'Mombello di Torino', 'Mombello Monferrato', 'Mombercelli', 'Momo', 'Mompantero', 'Momperone', 'Monale', 'Monastero Bormida', 'Monastero di Lanzo', 'Monastero di Vasco', 'Monasterolo Casotto', 'Monasterolo di Savigliano', 'Moncalieri', 'Moncalvo', 'Moncenisio', 'Moncestino', 'Monchiero', 'Moncrivello', 'Moncucco Torinese', "Mondovi'", 'Monesiglio', "Monforte d'Alba", 'Mongardino', 'Mongiardino Ligure', 'Mongrando', 'Monleale', "Monta'", 'Montabone', 'Montacuto', 'Montafia', 'Montaldeo', 'Montaldo Bormida', "Montaldo di Mondovi'", 'Montaldo Roero', 'Montaldo Scarampi', 'Montaldo Torinese', 'Montalenghe', 'Montalto Dora', 'Montanaro', 'Montanera', 'Montecastello', "Montechiaro d'Acqui", "Montechiaro d'Asti", 'Montecrestese', 'Montegioco', "Montegrosso d'Asti", 'Montelupo Albese', 'Montemagno', 'Montemale di Cuneo', 'Montemarzino', 'Monterosso Grana', 'Montescheno', 'Monteu da Po', 'Monteu Roero', 'Montezemolo', "Monticello d'Alba", 'Montiglio Monferrato', 'Morano sul Po', 'Moransengo', 'Morbello', 'Moretta', 'Moriondo Torinese', 'Mornese', 'Morozzo', 'Morsasco', "Motta de' Conti", 'Mottalciata', 'Murazzano', 'Murello', 'Murisengo', 'Muzzano', 'Narzole', 'Nebbiuno', 'Neive', 'Netro', 'Neviglie', 'Nibbiola', 'Nichelino', 'Niella Belbo', 'Niella Tanaro', 'Nizza Monferrato', 'Noasca', 'Nole', 'Nomaglio', 'None', 'Nonio', 'Novalesa', 'NOVARA', 'Novello', 'Novi Ligure', 'Nucetto', 'Occhieppo Inferiore', 'Occhieppo Superiore', 'Occimiano', 'Odalengo Grande', 'Odalengo Piccolo', 'Oggebbio', 'Oglianico', 'Olcenengo', 'Oldenico', 'Oleggio', 'Oleggio Castello', 'Olivola', 'Olmo Gentile', 'Omegna', 'Oncino', 'Orbassano', 'Orio Canavese', 'Ormea', 'Ornavasso', 'Orsara Bormida', 'Orta San Giulio', 'Osasco', 'Osasio', 'Ostana', 'Ottiglio', 'Oulx', 'Ovada', 'Oviglio', 'Ozegna', 'Ozzano Monferrato', 'Paderna', 'Paesana', 'Pagno', 'Palazzo Canavese', 'Palazzolo Vercellese', 'Pallanzeno', 'Pamparato', 'Pancalieri', 'Parella', 'Pareto', 'Parodi Ligure', 'Paroldo', 'Paruzzaro', 'Passerano Marmorito', 'Pasturana', 'Pavarolo', 'Pavone Canavese', 'Pecetto di Valenza', 'Pecetto Torinese', 'Pella', 'Penango', 'Perletto', 'Perlo', 'Perosa Argentina', 'Perosa Canavese', 'Perrero', 'Pertengo', 'Pertusio', 'Pessinetto', 'Pettenasco', 'Pettinengo', 'Peveragno', 'Pezzana', 'Pezzolo Valle Uzzone', 'Pianezza', 'Pianfei', 'Piasco', 'Piatto', 'Piea', 'Piedicavallo', 'Piedimulera', 'Pietra Marazzi', 'Pietraporzio', 'Pieve Vergonte', 'Pila', 'Pinasca', 'Pinerolo', "Pino d'Asti", 'Pino Torinese', "Piobesi d'Alba", 'Piobesi Torinese', 'Piode', 'Piossasco', "Piova' Massaia", 'Piozzo', 'Pisano', 'Piscina', 'Piverone', 'Pocapaglia', 'Pogno', 'Poirino', 'Pollone', 'Polonghera', 'Pomaretto', 'Pomaro Monferrato', 'Pombia', 'Ponderano', 'Pont-Canavese', 'Pontechianale', 'Pontecurone', 'Pontestura', 'Ponti', 'Ponzano Monferrato', 'Ponzone', 'Portacomaro', 'Porte', 'Portula', 'Postua', 'Pozzol Groppo', 'Pozzolo Formigaro', 'Pradleves', 'Pragelato', 'Prali', 'Pralormo', 'Pralungo', 'Pramollo', 'Prarolo', 'Prarostino', 'Prasco', 'Prascorsano', 'Pratiglione', 'Prato Sesia', 'Pray', 'Prazzo', 'Predosa', 'Premeno', 'Premia', 'Premosello-Chiovenda', 'Priero', 'Priocca', 'Priola', 'Prunetto', 'Quagliuzzo', 'Quaranti', 'Quaregna Cerreto', 'Quargnento', 'Quarna Sopra', 'Quarna Sotto', 'Quarona', 'Quassolo', 'Quattordio', 'Quincinetto', 'Quinto Vercellese', 'Racconigi', 'Rassa', 'Re', 'Reano', 'Recetto', 'Refrancore', 'Revello', "Revigliasco d'Asti", 'Ribordone', 'Ricaldone', 'Rifreddo', 'Rimella', 'Rittana', 'Riva presso Chieri', 'Rivalba', 'Rivalta Bormida', 'Rivalta di Torino', 'Rivara', 'Rivarolo Canavese', 'Rivarone', 'Rivarossa', 'Rive', 'Rivoli', 'Roaschia', 'Roascio', 'Roasio', 'Roatto', 'Robassomero', 'Robella', 'Robilante', 'Roburent', 'Rocca Canavese', "Rocca Ciglie'", "Rocca d'Arazzo", "Rocca de' Baldi", 'Rocca Grimalda', 'Roccabruna', 'Roccaforte Ligure', "Roccaforte Mondovi'", 'Roccasparvera', 'Roccaverano', 'Roccavione', 'Rocchetta Belbo', 'Rocchetta Ligure', 'Rocchetta Palafea', 'Rocchetta Tanaro', 'Roddi', 'Roddino', 'Rodello', 'Roletto', 'Romagnano Sesia', 'Romano Canavese', 'Romentino', 'Ronco Biellese', 'Ronco Canavese', 'Rondissone', 'Ronsecco', 'Roppolo', "Rora'", 'Rosazza', 'Rosignano Monferrato', 'Rossa', 'Rossana', 'Rosta', 'Roure', 'Rovasenda', 'Rubiana', 'Rueglio', 'Ruffia', 'Sagliano Micca', 'Sala Biellese', 'Sala Monferrato', 'Salasco', 'Salassa', 'Salbertrand', 'Sale', 'Sale delle Langhe', 'Sale San Giovanni', 'Salerano Canavese', 'Sali Vercellese', 'Saliceto', 'Salmour', 'Saluggia', 'Salussola', 'Saluzzo', 'Salza di Pinerolo', 'Sambuco', 'Samone', 'Sampeyre', 'San Benedetto Belbo', 'San Benigno Canavese', 'San Bernardino Verbano', 'San Carlo Canavese', 'San Colombano Belmonte', 'San Cristoforo', "San Damiano d'Asti", 'San Damiano Macra', 'San Didero', 'San Francesco al Campo', 'San Germano Chisone', 'San Germano Vercellese', 'San Giacomo Vercellese', 'San Gillio', 'San Giorgio Canavese', 'San Giorgio Monferrato', 'San Giorgio Scarampi', 'San Giorio di Susa', 'San Giusto Canavese', 'San Martino Alfieri', 'San Martino Canavese', 'San Marzano Oliveto', 'San Maurizio Canavese', "San Maurizio d'Opaglio", 'San Mauro Torinese', "San Michele Mondovi'", 'San Nazzaro Sesia', 'San Paolo Solbrito', 'San Pietro Mosezzo', 'San Pietro Val Lemina', 'San Ponso', 'San Raffaele Cimena', 'San Salvatore Monferrato', 'San Sebastiano Curone', 'San Sebastiano da Po', 'San Secondo di Pinerolo', 'Sandigliano', "Sanfre'", 'Sanfront', 'Sangano', 'Santa Maria Maggiore', "Santa Vittoria d'Alba", "Sant'Agata Fossili", "Sant'Albano Stura", "Sant'Ambrogio di Torino", "Sant'Antonino di Susa", 'Santena', "Santhia'", 'Santo Stefano Belbo', 'Santo Stefano Roero', 'Sardigliano', 'Sarezzano', 'Sauze di Cesana', "Sauze d'Oulx", 'Savigliano', 'Scagnello', 'Scalenghe', 'Scarmagno', 'Scarnafigi', 'Sciolze', 'Scopa', 'Scopello', 'Scurzolengo', 'Serole', "Serralunga d'Alba", 'Serralunga di Crea', 'Serravalle Langhe', 'Serravalle Scrivia', 'Serravalle Sesia', 'Sessame', 'Sestriere', 'Settime', 'Settimo Rottaro', 'Settimo Torinese', 'Settimo Vittone', 'Sezzadio', 'Sillavengo', "Silvano d'Orba", 'Sinio', 'Sizzano', 'Soglio', 'Solero', 'Solonghello', 'Somano', 'Sommariva del Bosco', 'Sommariva Perno', 'Sordevolo', 'Soriso', 'Sostegno', 'Sozzago', 'Sparone', 'Spigno Monferrato', 'Spineto Scrivia', 'Stazzano', 'Strambinello', 'Strambino', 'Stresa', 'Strevi', 'Strona', 'Stroppiana', 'Stroppo', 'Suno', 'Susa', 'Tagliolo Monferrato', 'Tarantasca', 'Tassarolo', 'Tavagnasco', 'Tavigliano', 'Terdobbiate', 'Ternengo', 'Terruggia', 'Terzo', 'Ticineto', 'Tigliole', 'Toceno', 'Tollegno', 'Tonco', 'Tonengo', 'TORINO', 'Tornaco', 'Torrazza Piemonte', 'Torrazzo', 'Torre Bormida', 'Torre Canavese', "Torre Mondovi'", 'Torre Pellice', 'Torre San Giorgio', 'Torresina', 'Tortona', 'Trana', 'Trarego Viggiona', 'Trasquera', 'Traversella', 'Traves', 'Trecate', 'Treiso', 'Treville', 'Trezzo Tinella', 'Tricerro', "Trinita'", 'Trino', 'Trisobbio', 'Trofarello', 'Trontano', 'Tronzano Vercellese', 'Usseaux', 'Usseglio', 'Vaglio Serra', 'Vaie', 'Val della Torre', 'Val di Chy', 'Valchiusa', 'Valdengo', 'Valdieri', 'Valdilana', 'Valduggia', 'Valenza', 'Valfenera', 'Valgioie', 'Valgrana', 'Vallanzengo', 'Valle Cannobina', 'Valle San Nicolao', 'Vallo Torinese', 'Valloriate', 'Valmacca', 'Valperga', 'Valprato Soana', 'Valstrona', 'Vanzone con San Carlo', "Vaprio d'Agogna", 'Varallo', 'Varallo Pombia', 'Varisella', 'Varzo', 'Vauda Canavese', 'Veglio', 'Venaria Reale', 'Venasca', 'Venaus', 'VERBANIA', 'VERCELLI', 'Verduno', 'Vernante', 'Verolengo', 'Verrone', 'Verrua Savoia', 'Verzuolo', 'Vesime', 'Vespolate', "Vestigne'", "Vezza d'Alba", 'Viale', "Vialfre'", 'Viarigi', 'Vicoforte', 'Vicolungo', 'Vidracco', 'Vigliano Biellese', "Vigliano d'Asti", 'Vignale Monferrato', 'Vignole Borbera', 'Vignolo', 'Vignone', 'Vigone', 'Viguzzolo', 'Villa del Bosco', 'Villa San Secondo', 'Villadeati', 'Villadossola', 'Villafalletto', "Villafranca d'Asti", 'Villafranca Piemonte', 'Villalvernia', 'Villamiroglio', 'Villanova Biellese', 'Villanova Canavese', "Villanova d'Asti", "Villanova Mondovi'", 'Villanova Monferrato', 'Villanova Solaro', 'Villar Dora', 'Villar Focchiardo', 'Villar Pellice', 'Villar Perosa', 'Villar San Costanzo', 'Villarbasse', 'Villarboit', 'Villareggia', 'Villaromagnano', 'Villastellone', 'Villata', 'Villette', 'Vinadio', 'Vinchio', 'Vinovo', 'Vinzaglio', 'Viola', 'Virle Piemonte', 'Vische', 'Visone', 'Vistrorio', "Viu'", 'Viverone', 'Vocca', 'Vogogna', 'Volpedo', 'Volpeglino', 'Volpiano', 'Voltaggio', 'Volvera', 'Vottignasco', 'Zimone', 'Zubiena', 'Zumaglia']

driver = webdriver.Chrome(executable_path=mypath)
driver.get('https://opengis.csi.it/tiles/')
time.sleep(4)

element=driver.find_element_by_id('popup-content')

f1 = open('raw.txt', 'w')

mancanti=len(lista_comuni)

while (mancanti>0):
	result=element.get_attribute('innerHTML')
	parsed_html = BeautifulSoup(result)
	positivi=parsed_html.find('span', attrs={'class':'inspect-row'}).text
	comune=parsed_html.find('div', attrs={'class':'inspect-layer'}).text
	if comune in lista_comuni:
		mancanti=mancanti-1
		pos=lista_comuni.index(comune)
		lista_comuni[pos]=lista_comuni[pos]+','+positivi+'\n'
		f1.write(str(lista_comuni[pos]))
		for comune in lista_comuni:
			if 'positivi' not in comune: print(comune)
		print(mancanti)
f1.close()

with open('raw_ordered.txt', 'w') as f:
    for comune in lista_comuni:
        f.write("%s \n" % comune)

f.close()

driver.close()
